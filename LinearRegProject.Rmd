---
title: "LinearRegProject"
author: "Nan Zhang, Lichun He, Yuqi Zhang"
date: "11/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Should This Loan be Approved or Denied?

## Setup
```{r}
# Setup
library(lubridate)
library(tidyverse)
library(broom)

SBAnational_raw <- read.csv(file = "SBAnational.csv", header = T)
SBAnational_raw <- na.omit(SBAnational_raw)
#head(SBAnational_raw, 5)
#apply(is.na(SBAnational_raw), 2, sum)
```
## Section 1: Pre-Process

### Section 1.1: Data Cleaning
```{r}
# Choose the data after 2000
# Choose the data in NY
SBAnational <- SBAnational_raw %>% 
  mutate(DisbursementDate = dmy(DisbursementDate)) %>% 
  filter( LowDoc %in% c("Y", "N"), year(DisbursementDate) >= 2000, State =="NY")
nrow(SBAnational)

# Remove the 0's in NAICS
SBAnational$NAICS[SBAnational$NAICS==0] <- NA
SBAnational <- SBAnational[!is.na(SBAnational$NAICS), ]

#apply(is.na(SBAnational), 2, sum)
```

### Section 1.2: Values Replacing
```{r}
# Only keep the first two number
SBAnational$NAICS <- as.numeric(substr(as.character(SBAnational$NAICS), 
                                       start = 1, stop = 2))

# Change string to number
rmSym <- function(string){
  string <- substr(string, start = 2, stop = nchar(string))
  return(string)
}
SBAnational$DisbursementGross <- 
  as.numeric(gsub(",","", rmSym(SBAnational$DisbursementGross)))
SBAnational$BalanceGross <- 
  as.numeric(gsub(",","", rmSym(SBAnational$BalanceGross)))
SBAnational$GrAppv <- as.numeric(gsub(",","", rmSym(SBAnational$GrAppv)))
SBAnational$SBA_Appv <- as.numeric(gsub(",","", rmSym(SBAnational$SBA_Appv)))

head(SBAnational, 5)
apply(is.na(SBAnational), 2, sum)
SBAnational$BalanceGross
```

### Section 1.3: Data Re-format/Transformation
```{r}

```

## Section 2: Explore the Variables

### Section 2.1: Each industry default rate v.s NAICS
```{r}
SBAnational$NAICS
```

### Section 2.2: Y v.s X2 ...
```{r}

```

### Section 2.3: Y v.s X3 ...
```{r}

```

## Section 3: Fit Linear Model

### Section 3.1: Split Training-Testing data
```{r}
## 50% of the sample size
sample_size <- floor(0.5 * nrow(SBAnational))

## set the seed to make partition reproducible
set.seed(123)
train_index <- sample(seq_len(nrow(SBAnational)), size = sample_size)

SBA_train <- SBAnational[train_index, ]
SBA_test <- SBAnational[-train_index, ]
```

### Section 3.2: ...
```{r}

```

### Section 3.3: ...
```{r}

```

### Section 3.4: Summary
```{r}

```

## Section 4: Residuals

### Section 4.1: ...
```{r}

```

### Section 4.2: ...
```{r}

```

### Section 4.3: ...
```{r}

```

## Section 5: Testing/Validation

### Section 5.1: ...
```{r}

```

### Section 5.2: ...
```{r}

```

### Section 5.3: ...
```{r}

```

## Section 6: Prediction

### Section 6.1: ...
```{r}

```

### Section 6.2: ...
```{r}

```

### Section 6.3: ...
```{r}

```

## Section 7: Conclusion
